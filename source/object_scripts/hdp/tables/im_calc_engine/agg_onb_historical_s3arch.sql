DROP TABLE ${hivevar:DEP_ENV}_im_calc_engine.agg_onb_historical_s3arch;
CREATE EXTERNAL TABLE IF NOT EXISTS ${hivevar:DEP_ENV}_im_calc_engine.agg_onb_historical_s3arch(
matchcode_sha256 varchar(64), 
ispchbuyerscorepresent int, 
ecomm_email_click_2yr int, 
ecomm_email_click_1yr int, 
email_click_2yr int, 
email_click_rate_1yr decimal(15,5), 
email_click_rate_day14 decimal(15,5), 
email_desk_click_2yr int, 
email_desk_click_6mon int, 
email_desk_click_day21 int, 
email_desk_click_day7 int, 
email_click_1yr int, 
email_click_day14 int, 
entry_2yr int, 
entry_day7 int, 
entry_mobl_2yr int, 
entry_mobl_3mon int, 
entry_mobl_day21 int, 
entry_mobl_day30 int, 
entry_mobl_day7 int, 
entry_tabl_1yr int, 
email_mobl_open_day14 int, 
email_open_2yr int, 
email_open_rate_2yr decimal(15,5), 
email_open_rate_3mon decimal(15,5), 
email_open_rate_day30 decimal(15,5), 
email_tabl_open_1yr int, 
email_open_3mon int, 
email_open_day30 int, 
email_open_1yr int, 
email_open_day14 int, 
email_send_2yr int, 
email_send_day7 int, 
email_send_3mon int, 
email_send_day30 int, 
email_unsub_2yr int, 
email_unsub_3mon int, 
email_undel_3mon int, 
email_undel_6mon int, 
games_busunit41_day7 int, 
iw_2yr int, 
iw_busunit52_day7 int, 
iw_busunit7_1yr int, 
iw_busunit7_2yr int, 
reg_accountstatus_18_day21 int, 
reg_accountstatus_18_day30 int, 
reg_accountstatus_2_1yr int, 
reg_accountstatus_2_2yr int, 
reg_accountstatus_2_3mon int, 
reg_accountstatus_2_day21 int, 
reg_accountstatus_2_day7 int, 
reg_accountstatus_33_6mon int, 
reg_accountstatus_4_2yr int, 
reg_accountstatus_4_day21 int, 
reg_accountstatus_4_day7 int, 
reg_clk1_bc_2yr int, 
reg_cross_promt_bc_2yr int, 
reg_cross_promt_bc_6mon int, 
reg_portal_bc_3mon int, 
reg_edge_3mon int, 
reg_firefox_3mon int, 
reg_firefox_day30 int, 
reg_safari_1yr int, 
reg_safari_3mon int, 
reg_desk_2yr int, 
reg_microsoft_1yr int, 
reg_motorola_3mon int, 
reg_motorola_6mon int, 
reg_motorola_day14 int, 
reg_samsung_1yr int, 
reg_samsung_6mon int, 
reg_samsung_day14 int, 
reg_samsung_day30 int, 
reg_height_2yr int, 
reg_height_day14 int, 
reg_width_1yr int, 
reg_width_3mon int, 
reg_width_6mon int, 
reg_width_day30 int, 
reg_width_day7 int, 
reg_affiliate_mc_2yr int, 
reg_affiliate_mc_3mon int, 
reg_affiliate_mc_6mon int, 
reg_affiliate_mc_day30 int, 
reg_affiliate_mc_day7 int, 
reg_content_mc_1yr int, 
reg_content_mc_day21 int, 
reg_content_mc_day7 int, 
reg_email_mc_3mon int, 
reg_postcard_mc_1yr int, 
reg_postcard_mc_2yr int, 
reg_postcard_mc_day30 int, 
reg_postcard_mc_day7 int, 
reg_search_mc_2yr int, 
reg_social_mc_3mon int, 
reg_android_os_2yr int, 
reg_android_os_3mon int, 
reg_android_os_6mon int, 
reg_android_os_day14 int, 
reg_android_os_day21 int, 
reg_android_os_day30 int, 
reg_os_x_2yr int, 
reg_os_x_day14 int, 
reg_os_x_day7 int, 
reg_windows_os_6mon int, 
reg_windows_os_day30 int, 
reg_keono_pa_2yr int, 
reg_liquidwireless_pa_2yr int, 
reg_liquidwireless_pa_6mon int, 
reg_liveintent_pa_3mon int, 
reg_nanigans_pa_day30 int, 
reg_nanigans_pa_day7 int, 
reg_pch_pa_2yr int, 
reg_taboola_pa_1yr int, 
reg_taboola_pa_3mon int, 
reg_zeeto_pa_3mon int, 
reg_zeeto_pa_6mon int, 
reg_pt_direct_2yr int, 
reg_pt_direct_day7 int, 
reg_pt_linkout_1yr int, 
reg_pt_linkout_2yr int, 
reg_pt_pc_1yr int, 
reg_pt_pc_2yr int, 
reg_pt_pc_day30 int, 
reg_pt_ron_2yr int, 
reg_sub_id_108_2yr int, 
reg_daytime_3mon int, 
reg_nighttime_2yr int, 
reg_weekend_day14 int, 
reg_main_path_2yr int, 
fp_search_blg6_3mon int, 
fp_search_blg7_day21 int, 
fp_search_blg7_1yr int, 
search_desk_day30 int, 
search_desk_day7 int, 
search_nav_1yr int, 
search_nav_day30 int, 
search_nav_day7 int, 
search_tabl_day14 int, 
age int, 
apt_ind int, 
dob_ind int, 
stateprovince varchar(1000), 
title varchar(1000), 
emaildomain varchar(1000), 
domain_1yr int, 
domain_2yr int, 
domain_bellsouth_3mon int, 
domain_bellsouth_day21 int, 
domain_bellsouth_day30 int, 
domain_charter_day14 int, 
domain_comcast_2yr int, 
domain_comcast_day7 int, 
domain_cox_6mon int, 
domain_day7 int, 
domain_gmail_1yr int, 
domain_gmail_2yr int, 
domain_gmail_3mon int, 
domain_icloud_1yr int, 
domain_icloud_2yr int, 
domain_icloud_6mon int, 
domain_msn_1yr int, 
domain_outlook_1yr int, 
domain_sbcglobal_2yr int, 
domain_sbcglobal_day7 int, 
domain_verizon_1yr int, 
domain_verizon_2yr int, 
domain_yahoo_2yr int, 
domain_ymail_1yr int, 
domain_ymail_2yr int, 
rundate date, 
entry_day21 int, 
reg_bigger_faster__bc_1yr int, 
reg_portal_bc_2yr int, 
reg_google_postcards_pa_2yr int, 
gender varchar(20), 
entry_1yr int, 
entry_3mon int, 
entry_desk_2yr int, 
entry_desk_3mon int, 
entry_desk_day7 int, 
reg_accountstatus_3_1yr int, 
reg_accountstatus_3_2yr int, 
reg_accountstatus_3_6mon int, 
reg_acquisition_2yr int, 
reg_acq_bc_2yr int, 
reg_acq_bc_6mon int, 
reg_android_os_1yr int, 
reg_bigger_faster__bc_2yr int, 
reg_clk1_bc_day30 int, 
reg_email_mc_1yr int, 
reg_main_path_day30 int, 
reg_pch_lotto_pa_1yr int, 
reg_pch_lotto_pa_2yr int, 
reg_sub_id_11_1yr int, 
entry_day14 int)
PARTITIONED BY ( 
archive_date varchar(100))
ROW FORMAT SERDE 
'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' 
STORED AS INPUTFORMAT 
'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' 
OUTPUTFORMAT 
'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'
LOCATION
'gs://pch_mapr_im_hdlp_calcengine/${hivevar:DEP_ENV}/cold/onb/aggdata/agg_onb_historical'
;